var opening=document.querySelector(".popup-open"),popup=document.querySelector(".popup"),close=popup.querySelector(".popup-close"),form=popup.querySelector("form"),fio=popup.querySelector("[type=text]"),email=popup.querySelector("[type=email]"),letter=popup.querySelector("textarea"),isStorageSupport=!0,fiostorage="",mailstorage="";try{fiostorage=localStorage.getItem("fio"),mailstorage=localStorage.getItem("email")}catch(e){isStorageSupport=!1}opening.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("popup-show"),fiostorage&&mailstorage?(fio.value=fiostorage,email.value=mailstorage,letter.focus()):fiostorage?(fio.value=fiostorage,email.focus()):(mailstorage&&(email.value=mailstorage),fio.focus())}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("popup-show"),popup.classList.remove("popup-error")}),form.addEventListener("submit",function(e){fio.value&&email.value?isStorageSupport&&(localStorage.setItem("fio",fio.value),localStorage.setItem("email",email.value)):(e.preventDefault(),popup.classList.remove("popup-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("popup-error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),popup.classList.contains("popup-show")&&(popup.classList.remove("popup-show"),popup.classList.remove("popup-error")))});